@using Microsoft.AspNetCore.Components.Authorization

<CascadingAuthenticationState>
    <AuthorizeView Roles="@Roles">
        <Authorized>
            @ChildContent
        </Authorized>
        <NotAuthorized Context="context">
            @if (context.User.Identity?.IsAuthenticated != true)
            {
                <RedirectToLogin />
            }
            else
            {
                <div class="container mt-5">
                    <div class="alert alert-danger">
                        <h4>Acceso denegado</h4>
                        <p>No tiene los permisos necesarios para acceder a esta p√°gina.</p>
                        <a href="/" class="btn btn-primary">Volver al inicio</a>
                    </div>
                </div>
            }
        </NotAuthorized>
    </AuthorizeView>
</CascadingAuthenticationState>

@code {
    [Parameter]
    public RenderFragment ChildContent { get; set; }

    [Parameter]
    public string Roles { get; set; }

    private class RedirectToLogin : ComponentBase
    {
        [Inject]
        private NavigationManager Navigation { get; set; }

        protected override void OnInitialized()
        {
            Navigation.NavigateTo("/login", forceLoad: false);
        }
    }
} 