@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager NavigationManager

<nav class="nav-menu">
    <div class="section-title">Administración</div>
    <hr class="divider" />
    <div class="nav-item">
        <NavLink href="/" Match="NavLinkMatch.All" class="nav-link">
            <span class="nav-icon">@DashboardIcon</span>
            <span>Dashboard</span>
        </NavLink>
    </div>
    
    <AuthorizeView Roles="SystemAdmin,TenantAdmin">
        <div class="nav-item">
            <NavLink href="/users" class="nav-link">
                <span class="nav-icon">@UserIcon</span>
                <span>Usuarios</span>
            </NavLink>
        </div>
    </AuthorizeView>
    
    <AuthorizeView Roles="SystemAdmin,TenantAdmin">
        <div class="nav-item">
            <NavLink href="/roles" class="nav-link">
                <span class="nav-icon">@RolesIcon</span>
                <span>Roles</span>
            </NavLink>
        </div>
    </AuthorizeView>
    
    <AuthorizeView Roles="SystemAdmin,TenantAdmin">
        <div class="nav-item">
            <NavLink href="/permissions" class="nav-link">
                <span class="nav-icon">@PermisosIcon</span>
                <span>Permisos</span>
            </NavLink>
        </div>
    </AuthorizeView>
    
    <AuthorizeView Roles="SystemAdmin,TenantAdmin">
        <div class="nav-item">
            <NavLink href="/sectiondefinitions" class="nav-link">
                <span class="nav-icon">@SectionIcon</span>
                <span>Definición de Secciones</span>
            </NavLink>
        </div>
    </AuthorizeView>
    
    <AuthorizeView Roles="SystemAdmin">
        <div class="nav-item">
            <NavLink href="/systemadmin/tenants" class="nav-link">
                <span class="nav-icon">@TenantIcon</span>
                <span>Gestión de Inquilinos</span>
            </NavLink>
        </div>
    </AuthorizeView>
    
    <div class="section-title mt-4">Acceso</div>
    <hr class="divider" />
    <NotAuthorized>
        <div class="nav-item">
            <NavLink href="/login" class="nav-link">
                <span class="nav-icon">@LoginIcon</span>
                <span>Login</span>
            </NavLink>
        </div>
    </NotAuthorized>
    <AuthorizeView>
        <Authorized>
            <div class="nav-item">
                <button class="nav-link logout-link" @onclick="Logout">
                    <span class="nav-icon">@LogoutIcon</span>
                    <span>Logout</span>
                </button>
            </div>
        </Authorized>
    </AuthorizeView>
</nav>

@code {
    private async Task Logout()
    {
        // Redirige a /logout o implementa lógica de logout aquí
        NavigationManager.NavigateTo("/logout", forceLoad: true);
    }

    // SVG Icons minimalistas y pastel
    private MarkupString DashboardIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#7EC8E3' stroke-width='2' viewBox='0 0 24 24'><rect x='3' y='3' width='7' height='7' rx='2'/><rect x='14' y='3' width='7' height='7' rx='2'/><rect x='14' y='14' width='7' height='7' rx='2'/><rect x='3' y='14' width='7' height='7' rx='2'/></svg>";
    private MarkupString UserIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#A3C9A8' stroke-width='2' viewBox='0 0 24 24'><circle cx='12' cy='8' r='4'/><path d='M4 20c0-4 8-4 8-4s8 0 8 4'/></svg>";
    private MarkupString RolesIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#F7B7A3' stroke-width='2' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10'/><path d='M8 12l2 2 4-4'/></svg>";
    private MarkupString PermisosIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#B5B9F7' stroke-width='2' viewBox='0 0 24 24'><rect x='4' y='4' width='16' height='16' rx='2'/><path d='M9 9h6v6H9z'/></svg>";
    private MarkupString SectionIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#F7E3AF' stroke-width='2' viewBox='0 0 24 24'><rect x='3' y='7' width='18' height='13' rx='2'/><path d='M16 3v4M8 3v4'/></svg>";
    private MarkupString TenantIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#B5EAD7' stroke-width='2' viewBox='0 0 24 24'><rect x='3' y='7' width='18' height='13' rx='2'/><path d='M16 3v4M8 3v4'/></svg>";
    private MarkupString LoginIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#A3C9A8' stroke-width='2' viewBox='0 0 24 24'><path d='M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4'/><polyline points='10 17 15 12 10 7'/><line x1='15' y1='12' x2='3' y2='12'/></svg>";
    private MarkupString LogoutIcon => (MarkupString)"<svg width='20' height='20' fill='none' stroke='#F7B7A3' stroke-width='2' viewBox='0 0 24 24'><path d='M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4'/><polyline points='16 17 21 12 16 7'/><line x1='21' y1='12' x2='9' y2='12'/></svg>";
} 